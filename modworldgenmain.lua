env._G=GLOBAL;local a=GetModConfigData("mods")local b=GetModConfigData("whitelist")_G.setfenv(1,_G)local c={}if a and type(a)=="table"then c=a end;local d=KnownModIndex.IsModCompatibleWithMode;KnownModIndex.IsModCompatibleWithMode=function(self,e,...)if rawget(_G,"TheNet")and type(b)=="table"and b[TheNet:GetUserID()]then return d(self,e,...)end;local f=KnownModIndex:GetModInfo(e)if not c[e]and(not f or f.client_only_mod)then return false end;return d(self,e,...)end;if rawget(_G,"ModManager")then local g=ModManager.InitializeModMain;ModManager.InitializeModMain=function(self,e,...)if rawget(_G,"TheNet")and type(b)=="table"and b[TheNet:GetUserID()]then return g(self,e,...)end;local f=KnownModIndex:GetModInfo(e)if not c[e]and(not f or f.client_only_mod)then local h=string.split(package.path,";")for i,j in ipairs(h)do local k=j:match("[workshop-]+%d+")if k then local f=KnownModIndex:GetModInfo(k)if not c[k]and(not f or f.client_only_mod)then table.remove(h,i)end end end;package.path=table.concat(h,";")end;return g(self,e,...)end end